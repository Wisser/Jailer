<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Jailer</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="description" content="Data Export Tool">
  <meta name="keywords"
 content="data export referential integrity java jdbc dbms">
  <link rel="stylesheet" type="text/css"
 href="deleting-data-Dateien/styles.css">
<link rel="shortcut icon" href="favicon.ico" >

</head>
<body left-margin="0" top-margin="0">
<div align="left">
<table
 style="text-align: left; position: absolute; left: 0pt; top: 0pt;"
 border="0" cellpadding="0" cellspacing="0" height="407" width="100%">
  <tbody>
    <tr>
      <td colspan="2" class="bannerbackground" height="33" width="100%">
      <table border="0" cellpadding="0" cellspacing="0">
        <tbody>
          <tr>
            <td><img src="deleting-data-Dateien/logo.png" hspace="10"></td>
            <td class="slogan" width="100%">Model-based&nbsp;Data&nbsp;Export</td>
            <td style="text-align: right; width: 100%;"><a
 href="http://sourceforge.net/projects/jailer/"><img
 src="http://sflogo.sourceforge.net/sflogo.php?group_id=197260&amp;type=1"
 alt="SourceForge.net Logo" style="border: 0px solid ;"></a></td>
          </tr>
        </tbody>
      </table>
      <b><font color="#ffffff">&nbsp; </font></b></td>
    </tr>
    <tr>
      <td colspan="2" class="nav1background" height="33" width="100%">&nbsp;
      <b><font color="#ffffff"><a href="home.htm" target="_self"
 class="tlink">Home</a> &nbsp;&nbsp;&nbsp; <a
 href="quicktour.htm" target="_self" class="tlink">Documentation</a>&nbsp;&nbsp;&nbsp; <a href="exporting-data.htm"
 target="_self" class="tlinkA">Tutorial</a>
&nbsp;&nbsp;&nbsp; <a
 href="http://sourceforge.net/project/showfiles.php?group_id=197260"
 target="_self" class="tlink">Download</a> &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;</font></b></td>
    </tr>
    <tr>
      <td colspan="2" class="spacer" width="100%">
      </td>
    </tr>
    <tr>
      <td class="lmenucontainer" height="100%" valign="top" width="14%">
      <div align="center">
      <center>
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td width="100%"><br>
            </td>
          </tr>
        </tbody>
      </table>
      </center>
      </div>
      <ul>
        <li><a href="exporting-data.htm" target="_self" class="llink">Exporting
Data</a></li>
        <li><a href="deleting-data.htm" target="_self" class="llinkA">Deleting
Data</a></li>
      </ul>
      <table border="0" cellpadding="5" cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td class="content2background"><img
 style="width: 160px; height: 1px;" alt=""
 src="architecture-Dateien/vgradp.gif"></td>
          </tr>
        </tbody>
      </table>
      </td>
      <td class="contentbackground" height="418" valign="top"
 width="86%">
      <div align="right">
      <table border="0" cellpadding="0" cellspacing="0" height="542"
 width="98%">
        <tbody>
          <tr>
            <td class="contentbackground" height="21" width="100%"> <br>
            </td>
          </tr>
          <tr>
            <td class="content" height="520" valign="top" width="100%">
            <small><small>&nbsp;</small></small><br>
This tutorial shows you how to delete rows from database without
violating integrity of the remaining data.<br>
            <br>
The generation of a <span style="font-style: italic;">delete-script</span>
is closely coupled with data export. The same restrictions are applied,
no row will be deleted which is not also exported. This way you can
always restore deleted rows by re-importing them.<br>
            <br>
A delete-script contains DELETE statements for all exported rows which
are not associated<br>
with any non-exported row according to the restricted data model.
Additionally tables can <br>
be excluded from deletion so that their rows will never be deleted, see
step 3.<br>
            <h3><br>
            </h3>
            <h4>Step 1. Delete Scott (unsuccessful)</h4>
Open the extraction model <big><span style="font-family: monospace;">scott.csv</span></big>
from previous
tutorial. Use <span style="font-style: italic;">Tools-&gt;Export Data</span>
again and enter <big><span style="font-family: monospace;">delete-scott.sql</span></big>
as name of delete-script:<br>
            <p> <img src="deleting-data-Dateien/screen17.png"><br>
            </p>
            <p><br>
Jailer will now generate the following script too:<br>
            <br>
            <table
 style="background-color: rgb(51, 102, 255); text-align: left;"
 border="0" cellpadding="2" cellspacing="0">
              <tbody>
                <tr>
                  <td
 style="vertical-align: top; height: 24px; background-color: rgb(202, 225, 235);"><big><span
 style="font-family: monospace;"><span style="font-weight: bold;"><span
 style="font-family: monospace;">delete-scott.sql </span></span></span><span
 style="font-family: monospace;"></span></big><br>
                  </td>
                </tr>
              </tbody>
            </table>
            <table style="width: 100%; text-align: left;" border="0"
 cellpadding="0" cellspacing="0">
              <tbody>
                <tr>
                  <td
 style="vertical-align: top; background-color: rgb(202, 225, 235);"
 colspan="2"><span style="font-family: monospace;"></span><span
 style="color: rgb(255, 0, 0); font-family: monospace;"></span><span
 style="font-family: monospace;">-- generated by Jailer at Fri May 02
12:34:35 CEST 2008&nbsp; from wisser@desktop<br>
--<br>
-- extraction model:&nbsp; EMPLOYEE where NAME='SCOTT'
(extractionmodel/scott.csv)<br>
-- database URL:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jdbc:db2://localhost/wisser<br>
-- database user:&nbsp;&nbsp;&nbsp;&nbsp; scott<br>
-- exported entities: 7<br>
--&nbsp;&nbsp;&nbsp;&nbsp;
DEPARTMENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2<br>
--&nbsp;&nbsp;&nbsp;&nbsp;
EMPLOYEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3<br>
--&nbsp;&nbsp;&nbsp;&nbsp;
SALARYGRADE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2<br>
--<br>
-- Tabu-tables:&nbsp; {&nbsp; }<br>
--<br>
-- entities to delete: 0<br>
                  </span></td>
                </tr>
              </tbody>
            </table>
            <br>
Jailer
has exported 7 entities but didn't delete anything! That's because
deleting Scott but not Scotts subordinate (who is not in the set
defined by the extraction-model!) would violate the integrity of the
remaining data.<br>
            <br>
            </p>
            <h4>Step 2. Delete Scott<br>
            </h4>
In order to delete Scott, me must delete his subordinate
too. To do so, relax the restriction on the <span
 style="font-style: italic;">inverse-BOSS</span>-association:
            <p><img src="deleting-data-Dateien/screen18.png"><br>
            <br>
            <br>
and <span style="font-style: italic;">Export Data </span>again:<br>
            <br>
            <table
 style="background-color: rgb(51, 102, 255); text-align: left;"
 border="0" cellpadding="2" cellspacing="0">
              <tbody>
                <tr>
                  <td
 style="vertical-align: top; height: 24px; background-color: rgb(202, 225, 235);"><big><span
 style="font-family: monospace;"><span style="font-weight: bold;"><span
 style="font-family: monospace;">delete-scott.sql </span></span></span><span
 style="font-family: monospace;"></span></big><br>
                  </td>
                </tr>
              </tbody>
            </table>
            <table style="width: 100%; text-align: left;" border="0"
 cellpadding="0" cellspacing="0">
              <tbody>
                <tr>
                  <td
 style="vertical-align: top; background-color: rgb(202, 225, 235);"
 colspan="2"><span style="font-family: monospace;"></span><span
 style="color: rgb(255, 0, 0); font-family: monospace;"></span><span
 style="font-family: monospace;">-- generated by Jailer at Wed Fri May
02 12:37:07 CEST 2008&nbsp; from wisser@desktop<br>
--<br>
-- extraction model:&nbsp; EMPLOYEE where NAME='SCOTT'
(extractionmodel/scott.csv)<br>
-- database URL:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jdbc:db2://localhost/wisser<br>
-- database user:&nbsp;&nbsp;&nbsp;&nbsp; scott<br>
-- exported entities: 9<br>
--&nbsp;&nbsp;&nbsp;&nbsp;
DEPARTMENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2<br>
--&nbsp;&nbsp;&nbsp;&nbsp;
EMPLOYEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
4<br>
--&nbsp;&nbsp;&nbsp;&nbsp;
SALARYGRADE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3<br>
--<br>
-- Tabu-tables:&nbsp; {&nbsp; }<br>
--<br>
-- entities to delete: 2<br>
--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
EMPLOYEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2 (-2)<br>
                  <br>
                  <br>
                  <br>
Delete from EMPLOYEE Where EMPNO in (7876);<br>
Delete from EMPLOYEE Where EMPNO in (7788);<br>
                  </span></td>
                </tr>
              </tbody>
            </table>
            <br>
The file <big><span style="font-family: monospace;"><font size="4">delete-scott.sql</font></span></big>
contains <big><span style="font-family: monospace;"><font size="4">Delete</font></span></big>-statements
for Scott and Adams.<br>
Note that <big><span style="font-family: monospace;"><font size="4">scott.sql</font></span></big>
now contains <big><span style="font-family: monospace;"><font size="4">Insert</font></span></big>-statements
for Adams and his salary-grade too. <br>
            <br>
            </p>
            <h4>Step 3. Delete all employees but no department</h4>
Replace the <span style="font-style: italic;">where</span>-condition
of the extraction model with '<big><span style="font-family: monospace;">1=1</span></big>',
or clear the field. Repeat the exportation. Jailer exports all
employees. The delete-script now contains the departments and
salary-grades too.<br>
            <br>
The reason why no department has been deleted in step 2 is that Scott
and Adams are not the only employees working in department 'RESEARCH'.
To prevent departments from being deleted if all their employees are
deleted, you can exclude the table from deletion.<br>
            <br>
Open the data model editor (<span style="font-style: italic;">Tools-&gt;Data
Model Editor</span>), select and <span style="font-style: italic;">edit</span>
table DEPARTMENT and switch-on <span style="font-style: italic;">exclude
from deletion</span>. Do the same with SALARYGRADE.<br>
            <br>
            <img src="deleting-data-Dateien/screen1.png"> <br>
            <br>
            <img src="deleting-data-Dateien/screen2.png"> <br>
            <br>
            <br>
Repeat exportation. The delete-script now contains only employees.<br>
            <br>
            <table
 style="background-color: rgb(51, 102, 255); text-align: left;"
 border="0" cellpadding="2" cellspacing="0">
              <tbody>
                <tr>
                  <td
 style="vertical-align: top; height: 24px; background-color: rgb(202, 225, 235);"><big><span
 style="font-family: monospace;"><span style="font-weight: bold;"><span
 style="font-family: monospace;">delete-scott.sql </span></span></span><span
 style="font-family: monospace;"></span></big><br>
                  </td>
                </tr>
              </tbody>
            </table>
            <table style="width: 100%; text-align: left;" border="0"
 cellpadding="0" cellspacing="0">
              <tbody>
                <tr>
                  <td
 style="vertical-align: top; background-color: rgb(202, 225, 235);"
 colspan="2"><span style="font-family: monospace;"></span><span
 style="color: rgb(255, 0, 0); font-family: monospace;"></span><span
 style="font-family: monospace;">-- generated by Jailer Fri May 02
12:37:31 CEST 2008&nbsp; from wisser@desktop</span><br
 style="font-family: monospace;">
                  <span style="font-family: monospace;">-- </span><br
 style="font-family: monospace;">
                  <span style="font-family: monospace;">-- extraction
model:&nbsp; EMPLOYEE where 1=1 (extractionmodel/f.csv)</span><br
 style="font-family: monospace;">
                  <span style="font-family: monospace;">-- database
URL:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jdbc:db2://dbsrv:50001/wisser</span><br
 style="font-family: monospace;">
                  <span style="font-family: monospace;">-- database
user:&nbsp;&nbsp;&nbsp;&nbsp; wisser</span><br
 style="font-family: monospace;">
                  <span style="font-family: monospace;">-- Exported
Entities: 22</span><br style="font-family: monospace;">
                  <span style="font-family: monospace;">--&nbsp;&nbsp;&nbsp;&nbsp;
DEPARTMENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3</span><br style="font-family: monospace;">
                  <span style="font-family: monospace;">--&nbsp;&nbsp;&nbsp;&nbsp;
EMPLOYEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
14</span><br style="font-family: monospace;">
                  <span style="font-family: monospace;">--&nbsp;&nbsp;&nbsp;&nbsp;
SALARYGRADE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
5</span><br style="font-family: monospace;">
                  <span style="font-family: monospace;">-- </span><br
 style="font-family: monospace;">
                  <span style="font-family: monospace;">--
Tabu-tables:&nbsp; { DEPARTMENT, SALARYGRADE }</span><br
 style="font-family: monospace;">
                  <span style="font-family: monospace;">-- </span><br
 style="font-family: monospace;">
                  <span style="font-family: monospace;">-- Deleted
Entities: 14</span><br style="font-family: monospace;">
                  <span style="font-family: monospace;">--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
EMPLOYEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
14</span><br style="font-family: monospace;">
                  <br style="font-family: monospace;">
                  <br style="font-family: monospace;">
                  <br style="font-family: monospace;">
                  <span style="font-family: monospace;">Delete from
EMPLOYEE Where EMPNO in (7369, 7499, 7521, 7654, 7844, 7876, 7900,
7934);</span><br style="font-family: monospace;">
                  <span style="font-family: monospace;">Delete from
EMPLOYEE Where EMPNO in (7698, 7782, 7788, 7902);</span><br
 style="font-family: monospace;">
                  <span style="font-family: monospace;">Delete from
EMPLOYEE Where EMPNO in (7566);</span><br
 style="font-family: monospace;">
                  <span style="font-family: monospace;">Delete from
EMPLOYEE Where EMPNO in (7839);</span><br>
                  <span style="font-family: monospace;"> </span></td>
                </tr>
              </tbody>
            </table>
            <br>
            <br>
            <p><br>
            <br>
            </p>
            </td>
          </tr>
        </tbody>
      </table>
      </div>
      <p>&nbsp; </p>
      </td>
    </tr>
    <tr>
      <td height="12" valign="top" width="14%"> <br>
      </td>
      <td> <br>
      </td>
    </tr>
  </tbody>
</table>
</div>
</body>
</html>
