<html><head><title>Open Jail. The Jailer Project Web Site</title>


<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="keywords" content="Data Export Tool">
<meta name="description" content="data export referential integrity java jdbc dbms">

<link rel="stylesheet" type="text/css" href="design-Dateien/styles.css"></head><body left-margin="0" top-margin="0">
<div align="left">
<table style="text-align: left; position: absolute; left: 0pt; top: 0pt;" border="0" cellpadding="0" cellspacing="0" height="407" width="100%">
<tbody><tr>
<td colspan="2" class="bannerbackground" height="33" width="100%"><table border="0" cellpadding="0" cellspacing="0">
<tbody><tr>
<td><img src="design-Dateien/logo.png" hspace="10"></td>
<td class="slogan">Data Export Tool</td></tr></tbody></table>
<b><font color="#ffffff">&nbsp; </font></b></td></tr>
<tr>
<td colspan="2" class="nav1background" height="33" width="100%">&nbsp; <b><font color="#ffffff">
<a href="home.htm" target="_self" class="tlink">Home</a> &nbsp;&nbsp;&nbsp; <a href="tutorial.htm" target="_self" class="tlink">Tutorial</a> &nbsp;&nbsp;&nbsp; 
<a href="documentation.htm" target="_self" class="tlinkA">Documentation</a> &nbsp;&nbsp;&nbsp; <a href="download.htm" target="_self" class="tlink">Download</a> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font></b></td></tr>
<tr>
<td colspan="2" class="spacer" height="21" width="100%"></td></tr>
<tr>
<td class="lmenucontainer" height="100%" valign="top" width="14%">
<div align="center">
<center>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="100%"></td></tr></tbody></table></center></div>
<ul>
<li><a href="architecture.htm" target="_self" class="llink">Architecture</a></li>
<li><a href="design.htm" target="_self" class="llinkA">Design</a></li>
<li><a href="file-formats.htm" target="_self" class="llink">File Formats</a></li>
<li><a href="terms.htm" target="_self" class="llink">Terms</a></li></ul>
<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tbody><tr>
<td class="content2background"><!-- rule--></td></tr></tbody></table><p>&nbsp;</p></td>
<td class="contentbackground" height="418" valign="top" width="86%">
<div align="right">
<table border="0" cellpadding="0" cellspacing="0" height="542" width="98%">
<tbody><tr>
<td class="contentbackground" height="21" width="100%"></td></tr>
<tr>
<td class="content" height="520" valign="top" width="100%"><h3><a name="modell_des_entitaetsgraphen">The Entity Graph</a></h3>
<div class="level3">
<p>During exportation a graph of entities will be produced inside the database. For this three tables are required: </p>
<ul>
<li class="level1">
<div class="li"><strong>EntityGraph</strong> the graph<br></div>
</li><li class="level1">
<div class="li"><strong>Entity</strong> entity in the graph<br></div>
</li><li class="level1">
<div class="li"><strong>Dependency</strong> dependencies between entities</div></li></ul>
<p>For each entity in the graph the primary-key <em></em>and the type<em></em><span style="font-style: italic;"></span>(as table name) ist stored. The <em>birthday</em> of an entity is the day of the insertion into the graph. </p></div>
<h3><a name="berechnung_des_transitiven_abschlusses">Finding the transitive closure</a></h3>
<div class="level3">
<p>The graph will be constructed day after day (step-by-step) starting at day 1: </p>
<ul>
<li class="level1">
<div class="li">at day 1 all subject entities are inserted into the graph<br></div>
</li><li class="level1">at day <big style="font-style: italic;"><span style="font-family: monospace;"><font size="4">n</font></span></big> all entities referenced by one of the entities born at day <big style="font-style: italic; font-family: monospace;"><font size="4">n-1</font></big> are inserted into the graph. Dependencies between entities are stored.<br></li></ul>
<p>The <em>progression set</em> of a day is the set of all tables from
which entities are inserted at that day. The progession set of day 1 is
the subject set. The process stops if the progression set of a day is
empty.<br></p></div>
<h4><a name="algorithmus">Algorithm</a></h4>
<div class="level4">
<ol>
<li class="level1">
<div class="li">insert <big><span style="font-style: italic; font-family: monospace;"><font size="4">subject</font></span></big> into graph<br></div>
</li><li class="level2">
<div class="li"><em><font size="4"><big><span style="font-family: monospace;">progression-set := subject</span></big><br></font></em></div>
</li><li class="level2">
<div class="li">while <big><em style="font-family: monospace;"><font size="4">progression-set != {}</font></em></big></div>
<ol>
<li class="level5" style="font-family: monospace;">
<div class="li"><big><em><font size="4">progression-of-today := {}</font></em></big></div>
</li><li class="level5">
<div class="li">for all restricted associations <em>A between tables T<small><font size="2">1</font></small> and T<small><font size="2">2</font></small></em><span style="font-style: italic;">, if</span><em> T<small><font size="2">1</font></small></em> oder <em>T<small><font size="2">2</font></small></em> in <em>progression-set:</em></div>
<ol>
<li class="level10">
<div class="li">if <em>T<small><font size="2">2</font></small></em>
<span style="font-style: italic;">(T<small><font size="2">1</font></small>) </span>depends on <em>T<small><font size="2">1 <big>(T<small>2</small>)</big></font></small></em>: add dependencies from <em>T<small><font size="2">2</font></small></em>(T<small><font size="2">1</font></small>)-entities born yesterday to the entities they are associated with according to <span style="font-style: italic;">A</span></div>
</li><li class="level10">
<div class="li">insert all entities of <em>T<small><font size="2">1</font></small> (T<small><font size="2">2</font></small>)</em>, which are associated according to <span style="font-style: italic;">A</span> with an entity of <span style="font-style: italic;">T<small><font size="2">2</font></small> (T<small><font size="2">1</font></small>)</span> born yesterday</div>
</li><li class="level10">
<div class="li">if at least one entity of T<small><font size="2">1</font></small> (T<small><font size="2">2</font></small>) is inserted then <big><em style="font-family: monospace;"><font size="4">progression-of-today := progression-of-today + {&nbsp;</font></em><span style="font-family: monospace;"><font size="4"> T</font><small>1</small><font size="4"> (T</font><small>2</small><font size="4">)</font></span><em style="font-family: monospace;"><font size="4"> }</font></em></big></div></li></ol>
</li><li class="level5" style="font-family: monospace;">
<div class="li"><big><em><font size="4">progression-set := progression-of-today</font></em></big></div></li></ol></li></ol></div>
<h4><a name="beispiel"><font size="4"></font></a></h4>
<h4><a name="beispiel"><font size="4"></font></a></h4>
<div class="level4">
<p><br><font size="4"><big>Example</big><br></font></p>
<p>Subject = <em>{ A<small><font size="2">1</font></small></em>, <em>A<small><font size="2">2</font></small></em> } </p>
<p><a href="http://intra.acoreus.de/dokuwiki/lib/exe/detail.php?id=projekte%3Aphase_1_datenextraktion&amp;cache=cache&amp;media=development:documentation:example.png"><img style="border: 0px solid ; width: 753px; height: 455px;" alt="desing" src="design-Dateien/example.png"></a><br><br><a class="media" title="development:documentation:example.png" href="http://intra.acoreus.de/dokuwiki/lib/exe/detail.php?id=projekte%3Aphase_1_datenextraktion&amp;cache=cache&amp;media=development:documentation:example.png"></a></p>
<table class="inline" border="1" cellpadding="2" cellspacing="0">
<tbody>
<tr>
<td style="background-color: rgb(153, 255, 255);"><strong>day</strong></td>
<td style="background-color: rgb(153, 255, 255);"><strong>progression set</strong></td>
<td style="background-color: rgb(153, 255, 255);"><strong>entities</strong></td>
<td style="background-color: rgb(153, 255, 255);"><strong>dependencies</strong></td></tr>
<tr>
<td>1</td>
<td>A</td>
<td>A1, A2</td>
<td><br></td></tr>
<tr>
<td>2</td>
<td>B, C</td>
<td>+ B1, B2, C3, C4</td>
<td>A2?C3, A2?C4</td></tr>
<tr>
<td>3</td>
<td>B, C</td>
<td>+ C1, C2, B3, B5</td>
<td>+ B1?C1, B1?C2</td></tr>
<tr>
<td>4</td>
<td>B</td>
<td>+ B6</td>
<td><em>no change</em></td></tr>
<tr>
<td>5</td>
<td><br></td>
<td><em>no change</em><em></em></td>
<td><em>no change</em></td></tr></tbody></table></div>
<h4><br></h4>
<h4><a name="sql-anweisungen">SQL-Statements</a></h4>
<p>Line 1, insert subject<br><span style="font-family: monospace;"><br>INSERT INTO Entity(PK, birthday, type)</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp; SELECT &lt;subject&gt;.PK, 1, '&lt;subject&gt;' </span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp; FROM &lt;subject&gt;</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; WHERE (&lt;condition&gt; AND 103</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOT EXISTS (SELECT * FROM Entity WHERE &lt;subject&gt;.PK=Entity.PK)</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; [fetch first &lt;limit&gt; rows only]</span><br style="font-family: monospace;"><br><br>Line 3.2.1, adding dependencies<br><br><span style="font-family: monospace;">INSERT INTO Dependency(from_PK, to_PK)</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp; SELECT &lt;T2&gt;.PK, &lt;T1&gt;.PK</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp; FROM Entity E1, Entity E2,</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;T2&gt; JOIN &lt;T1&gt; ON &lt;join-condition&gt;</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp; WHERE E1.type='&lt;T1&gt;' AND E2.type='&lt;T2&gt;'</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND E1.PK=&lt;T1&gt;.PK</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND E2.PK=&lt;T2&gt;.PK<br><br><br></span>Line 3.2.2, adding referenced entities<br><br><span style="font-family: monospace;">INSERT INTO Entity(PK, birthday, type)</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp; SELECT DISTINCT &lt;T2&gt;.PK, &lt;today&gt;, '&lt;T2&gt;'</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp; FROM &lt;T1&gt; JOIN &lt;T2&gt; ON &lt;join-condition&gt;,</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Entity</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp; WHERE &lt;T1&gt;.PK=Entity.PK AND Entity.birthday = &lt;yesterday&gt;</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND NOT EXISTS</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (SELECT * FROM Entity WHERE &lt;T2&gt;.PK=Entity.PK)</span><br style="font-family: monospace;"><br></p></td></tr></tbody></table></div>
<p>&nbsp; </p></td></tr>
<tr>
<td height="12" valign="top" width="14%"></td>
<td></td></tr></tbody></table></div></body></html>